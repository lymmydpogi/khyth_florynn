{% extends 'ADMIN/base.html.twig' %}

{% block title %}Edit Order{% endblock %}
{% block page_title %}Edit Order{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('style/css/ORDER/order-edit.css') }}">
{% endblock %}

{% block body %}
<div class="page-wrapper">
    <div class="content-container">

        <!-- Header Section -->
        <div class="header-section">
            <h1>Edit Order</h1>
            <p>Update order information</p>
        </div>

        <!-- Form Card -->
        <div class="form-card">
            {{ form_start(form, {'attr': {'class': 'order-form'}}) }}
            <div class="form-grid">
                <!-- Client -->
                <div class="form-group">
                    <label>Client</label>
                    {{ form_widget(form.user) }}
                    {{ form_errors(form.user) }}
                </div>

                <!-- Service -->
                <div class="form-group">
                    <label>Service</label>
                    {{ form_widget(form.service, {'attr': {'class': 'service-select'}}) }}
                    {{ form_errors(form.service) }}
                </div>

                <!-- Order Date -->
                <div class="form-group">
                    <label>Order Date</label>
                    {{ form_widget(form.orderDate) }}
                    {{ form_errors(form.orderDate) }}
                </div>

                <!-- Delivery Date -->
                <div class="form-group">
                    <label>Delivery Date</label>
                    {{ form_widget(form.deliveryDate) }}
                    {{ form_errors(form.deliveryDate) }}
                </div>

                <!-- Status -->
                <div class="form-group">
                    <label>Status</label>
                    {{ form_widget(form.status) }}
                    {{ form_errors(form.status) }}
                </div>

                <!-- Payment Status -->
                <div class="form-group">
                    <label>Payment Status</label>
                    {{ form_widget(form.paymentStatus) }}
                    {{ form_errors(form.paymentStatus) }}
                </div>

                <!-- Payment Method -->
                <div class="form-group">
                    <label>Payment Method</label>
                    {{ form_widget(form.paymentMethod) }}
                    {{ form_errors(form.paymentMethod) }}
                </div>

                <!-- Total Price -->
                <div class="form-group">
                    <label>Total Price</label>
                    {{ form_widget(form.totalPrice, {'attr': {'readonly': 'readonly', 'class': 'total-price'}}) }}
                    {{ form_errors(form.totalPrice) }}
                </div>

                <!-- Notes -->
                <div class="form-group" style="grid-column: span 2;">
                    <label>Notes</label>
                    {{ form_widget(form.notes) }}
                    {{ form_errors(form.notes) }}
                </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
                <a href="{{ path('app_order_index') }}" class="btn-back">Cancel</a>
                <button type="submit" class="btn-submit">Update Order</button>
            </div>

            {{ form_end(form) }}
        </div>

    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        $(document).ready(function() {
            const serviceField = $('.service-select');
            const priceField = $('.total-price');

            serviceField.change(function() {
                const selectedOption = $(this).find('option:selected');
                const price = selectedOption.data('price');
                priceField.val(price ? parseFloat(price).toFixed(2) : '');
            });

            serviceField.trigger('change');
        });
    </script>
{% endblock %}