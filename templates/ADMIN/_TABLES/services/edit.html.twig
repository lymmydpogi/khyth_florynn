{% extends 'ADMIN/base.html.twig' %}

{% block title %}Edit Service{% endblock %}
{% block page_title %}Edit Service{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('style/css/SERVICE/service-edit.css') }}">
{% endblock %}

{% block body %}
<div class="page-wrapper">
    <div class="content-container">

        <!-- Header -->
        <div class="header-section">
            <h1>Edit Service</h1>
            <p>Update the service details below</p>
        </div>

        <!-- Form Card -->
        <div class="form-card">
            {{ form_start(form) }}

            <div class="form-grid">
    <div class="form-group">{{ form_row(form.name) }}</div>
    <div class="form-group">{{ form_row(form.price) }}</div>
    <div class="form-group">{{ form_row(form.status) }}</div>
    <div class="form-group">{{ form_row(form.pricingModel) }}</div>
    <div class="form-group">{{ form_row(form.pricingUnit) }}</div>
    <div class="form-group">{{ form_row(form.deliveryTime) }}</div>
    <div class="form-group">{{ form_row(form.category) }}</div>
    <div class="form-group">{{ form_row(form.toolsUsed) }}</div>
    <div class="form-group">{{ form_row(form.revisionLimit) }}</div>
    <div class="form-group form-description">{{ form_row(form.description) }}</div>
</div>

            <div class="form-actions">
                <button type="submit" class="btn btn-update">Update Service</button>
                <a href="{{ path('app_services_index') }}" class="btn btn-back">Back to Services</a>
            </div>

            {{ form_end(form) }}
        </div>

    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const pricingModel = document.querySelector("[name$='[pricingModel]']");
    const pricingUnit = document.querySelector("[name$='[pricingUnit]']");

    const unitMap = {
        fixed: ['project', 'package', 'deliverable'],
        hourly: ['hour', 'day', 'week'],
        milestone: ['milestone', 'phase', 'stage']
    };

    function filterUnits() {
        const selectedModel = pricingModel.value;
        const options = Array.from(pricingUnit.options);

        options.forEach(option => {
            if (unitMap[selectedModel]?.includes(option.value)) {
                option.hidden = false;
            } else {
                option.hidden = true;
            }
        });

        // Reset invalid selection
        if (pricingUnit.selectedOptions[0]?.hidden) {
            pricingUnit.value = "";
        }
    }

    pricingModel.addEventListener("change", filterUnits);
    filterUnits(); // Run on load
});
</script>
{% endblock %}
